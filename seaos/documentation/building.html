---
layout: default
title: Building - Documentation - SeaOS
---

<div class="row">
	<div class="large-3 columns panel">
		<div class="row text-center">
			<a href="http://github.com/dbittman/seakernel" target="_blank" class="button"><img src="icons/github.png">Source Code</a>
		</div>
		<hr>
		<ul>
			<li><a href="seaos/index.html">SeaOS</a></li>
			<li><a href="seaos/releases.html">Download</a></li>
			<li><a href="seaos/documentation/index.html">Documentation</a></li>
		</ul>
	</div>

	<div class="large-9 columns">
		<h2>SeaOS - Building</h2>
		<hr>
		<p><em>Building is only supported on Linux</em></p>
		<p>Building the kernel is only supported using a cross compiler, ether <code>i586-pc-seaos-gcc</code> or <code>x86_64-pc-seaos-gcc</code>.
		This cross compiler
		is built by the SeaOS userland source code, available at <a href="http://github.com/dbittman/sea">github.com/dbittman/sea</a>. Instructions for
		building it are available within that repository. Once built and added to your PATH variable, the makefile in seakernel will use it to compile
		the kernel.</p>

		<h3>Checking Out the Source</h3>
		<p>To check out the source, run <code>git clone https://github.com/dbittman/sea</code>, cd into that directory, and run <code>git clone https://github.com/dbittman/seakernel</code>.
		This checks out the SeaOS userland repo, and places the SeaOS kernel inside it.</p>

		<h3>Building The Cross-Compiler</h3>
		<p>The kernel requires a compiled version of binutils and gcc in order to be compiled. For user-land applications, additional libraries must be built (
		such as the C library, and others). The SeaOS userland builds all these automatically using a ruby script. Ruby version 2.0.0 or greater is recommended.
		</p>

		<p>Before doing anything, the configure script must be run. This will ask for a location to put the toolchain. Anywhere where you can read, write, and execute
		files is good. It will also ask for a loop device to use. This is required to build the harddrive image. </p>

		<p>In order to build the 32-bit toolchain (which will compile the 32-bit kernel ONLY), simply running <code>make toolchain</code> in the SeaOS userland
		repo and selecting <code>i586</code> will do it. This will probably take a long time, unless your computer is amazing. If you want to compile the 64-bit
		version, select <code>x86_64</code>. If you have previously installed the toolchain and you want to re-install or install a different version or architecture,
		you must cd into the tools directory and run <code>ruby build.rb all-all --reinstall</code>, and then select the architecture.</p>

		<h3>Preparing the Userland</h3>
		<p>
		In order to build a working OS, the programs and configuration files must be downloaded
		and installed. To do this, run <code>make apps</code> (or <code>make apps64</code> for
		the 64 bit versions. Both the 64bit and 32bit apps can be downloaded simultaneuously).
		</p>
		<p>
		<em>WARNING - creating a hard disk image requires legacy grub. A binary is provided
			in the userspace repo, but it <strong>requires</strong> 32bit linux libraries
			to run. If your host machine is 64bit, make sure you have the right 32bit
			compatibility libraries installed. If you don't see GRUB messages during disk
			image creation, or if you test the disk image after installing the kernel and
			it doesn't boot, then GRUB failed to execute.</em>
		</p>
		<p>Optionally, you can generate the man pages for the applications by running <code>make man</code>.</p>


		<h3>Basic Compilation - Defaults</h3>

		<p>The kernel provides a default configuration (currently 32-bit x86) to make things simple. Just run 'make'. This
		will generate the hard drive image, compile the kernel, generate the initrd, and put them all on the hard drive image.
		</p>
		<p>The recommended way to test SeaOS is using the emulator Qemu. Sane defaults are provided
		by the make target <code>qemu</code>. Other targets are available, that add basic
		networking, nested KVM, and others. If your computer doesn't support KVM, remove the
		<code>-enable-kvm</code> line from <code>local_make.inc</code>.
		</p>

		<h3>Advanced Compilation</h3>
		<p>In reality, the source tree contains a build directory in which is a directory called 'default'. The makefile reads
		the environment variables BUILDCFG. If this is not specified, it takes the value 'default'. In build/default is provided
		a default configuration that's ready for building.</p>

		<p>Note that this is true for both the userland repo and the kernel repo itself.</p>

		<p>You can create your own configuration by running "tools/cfg-new [name] [arch]" in the userland repo. This will create
		a new configuration in build/ that will generate a hard drive image with the userspace programs specified by arch (so 64bit or
		32bit depending on x86_64 or i586). It will then also create a build configuration for the kernel as well, and run the configure
		script. This will ask a bunch of questions, but just make sure to match the userland architecture with the kernel architecture.</p>

		<p>If you've created multiple configurations, you can select which one to build and use / test by setting BUILDCFG to the name
		of the configuration that you want to use.</p>

	</div>


</div>

